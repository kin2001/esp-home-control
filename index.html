<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ESP Home Control</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 100px; }
    button { font-size: 1.5em; margin: 20px; padding: 20px; border-radius: 10px; border: none; }
  </style>
</head>
<body>
  <h1>ESP8266 Remote Control</h1>
  <button onclick="toggle('light')">Toggle Light</button>
  <button onclick="toggle('fan')">Toggle Fan</button>

  <script>
    async function toggle(device) {
      const token = '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'; // Replace with your token
      const owner = 'kin2001';
      const repo = 'esp-home-control';
      const path = 'commands.json';

      // Fetch current file from GitHub
      const response = await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
        headers: { Authorization: `token ${token}` }
      });
      const data = await response.json();
      const content = JSON.parse(atob(data.content));

      content[device] = !content[device];

      // Push updated content
      await fetch(`https://api.github.com/repos/${owner}/${repo}/contents/${path}`, {
        method: 'PUT',
        headers: {
          Authorization: `token ${token}`,
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          message: `Toggle ${device}`,
          content: btoa(JSON.stringify(content, null, 2)),
          sha: data.sha
        })
      });

      alert(`${device} toggled!`);
    }
  </script>
</body>
</html>
